WARNING:root:Limited tf.compat.v2.summary API due to missing TensorBoard installation.
WARNING:tensorflow:From AIP_bnn.py:101: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From AIP_bnn.py:101: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From AIP_bnn.py:151: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From AIP_bnn.py:151: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /lustre/home/simonrs/implicit-processes/prior_tests/regular_prior/bnn_prior/test_bim/prior_BNN.py:109: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

WARNING:tensorflow:From /lustre/home/simonrs/implicit-processes/prior_tests/regular_prior/bnn_prior/test_bim/prior_BNN.py:109: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

WARNING:tensorflow:From AIP_bnn.py:278: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From AIP_bnn.py:278: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/ops/math_ops.py:2509: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/ops/math_ops.py:2509: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From AIP_bnn.py:365: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From AIP_bnn.py:365: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From AIP_bnn.py:377: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From AIP_bnn.py:377: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From AIP_bnn.py:382: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From AIP_bnn.py:382: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-12-08 16:26:10.451155: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-12-08 16:26:10.458137: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2394350000 Hz
2020-12-08 16:26:10.458334: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a6df678030 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-08 16:26:10.458380: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-08 16:26:10.459675: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-08 16:26:10.473535: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:02:00.0
2020-12-08 16:26:10.474688: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2020-12-08 16:26:10.477087: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2020-12-08 16:26:10.479294: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2020-12-08 16:26:10.480205: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2020-12-08 16:26:10.482780: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2020-12-08 16:26:10.485045: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2020-12-08 16:26:10.490553: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-12-08 16:26:10.492191: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-12-08 16:26:10.492248: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2020-12-08 16:26:10.597712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-08 16:26:10.597819: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-12-08 16:26:10.597843: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-12-08 16:26:10.600218: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4884 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:02:00.0, compute capability: 6.0)
2020-12-08 16:26:10.602276: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55a6e04aecc0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-12-08 16:26:10.602314: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From AIP_bnn.py:384: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From AIP_bnn.py:384: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2020-12-08 16:26:11.488835: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2020-12-08 16:26:12.280745: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x55a6e04a1070
2020-12-08 16:26:12.280945: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2020-12-08 16:26:12.511330: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
Traceback (most recent call last):
  File "AIP_bnn.py", line 618, in <module>
    main(available_perm[split,], split, alpha, layers)
  File "AIP_bnn.py", line 440, in main
    cross_entropy_q], feed_dict={x: batch[ 0 ], y_: batch[ 1 ], n_samples: n_samples_train, kl_factor_: kl_factor})
  File "/home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/client/session.py", line 956, in run
    run_metadata_ptr)
  File "/home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/client/session.py", line 1180, in _run
    feed_dict_tensor, options, run_metadata)
  File "/home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/client/session.py", line 1359, in _do_run
    run_metadata)
  File "/home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/client/session.py", line 1384, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: 2 root error(s) found.
  (0) Invalid argument: Cholesky decomposition was not successful. The input might not be valid.
	 [[node Cholesky_1 (defined at /home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/framework/ops.py:1748) ]]
	 [[Mean_7/_705]]
  (1) Invalid argument: Cholesky decomposition was not successful. The input might not be valid.
	 [[node Cholesky_1 (defined at /home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/framework/ops.py:1748) ]]
0 successful operations.
0 derived errors ignored.

Original stack trace for u'Cholesky_1':
  File "AIP_bnn.py", line 618, in <module>
    main(available_perm[split,], split, alpha, layers)
  File "AIP_bnn.py", line 271, in main
    chol_decomposition = tf.cast( tf.linalg.cholesky( inner_cholesky ), dtype = tf.float64 )
  File "/home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/ops/gen_linalg_ops.py", line 820, in cholesky
    "Cholesky", input=input, name=name)
  File "/home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/framework/op_def_library.py", line 794, in _apply_op_helper
    op_def=op_def)
  File "/home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/util/deprecation.py", line 507, in new_func
    return func(*args, **kwargs)
  File "/home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/framework/ops.py", line 3357, in create_op
    attrs, op_def, compute_device)
  File "/home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/framework/ops.py", line 3426, in _create_op_internal
    op_def=op_def)
  File "/home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/framework/ops.py", line 1748, in __init__
    self._traceback = tf_stack.extract_stack()

WARNING:root:Limited tf.compat.v2.summary API due to missing TensorBoard installation.
WARNING:tensorflow:From AIP_bnn.py:101: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From AIP_bnn.py:101: The name tf.set_random_seed is deprecated. Please use tf.compat.v1.set_random_seed instead.

WARNING:tensorflow:From AIP_bnn.py:151: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From AIP_bnn.py:151: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /lustre/home/simonrs/implicit-processes/prior_tests/regular_prior/bnn_prior/test_bim/prior_BNN.py:109: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

WARNING:tensorflow:From /lustre/home/simonrs/implicit-processes/prior_tests/regular_prior/bnn_prior/test_bim/prior_BNN.py:109: The name tf.random_normal is deprecated. Please use tf.random.normal instead.

WARNING:tensorflow:From AIP_bnn.py:278: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From AIP_bnn.py:278: The name tf.log is deprecated. Please use tf.math.log instead.

WARNING:tensorflow:From /home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/ops/math_ops.py:2509: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From /home/proyectos/ada2/dhernand/tensorflow/lib/python2.7/site-packages/tensorflow_core/python/ops/math_ops.py:2509: where (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
WARNING:tensorflow:From AIP_bnn.py:365: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From AIP_bnn.py:365: The name tf.train.AdamOptimizer is deprecated. Please use tf.compat.v1.train.AdamOptimizer instead.

WARNING:tensorflow:From AIP_bnn.py:377: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From AIP_bnn.py:377: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

WARNING:tensorflow:From AIP_bnn.py:382: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

WARNING:tensorflow:From AIP_bnn.py:382: The name tf.Session is deprecated. Please use tf.compat.v1.Session instead.

2020-12-09 04:38:52.812246: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2020-12-09 04:38:52.948813: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2394350000 Hz
2020-12-09 04:38:52.949170: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564a222220e0 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-12-09 04:38:52.949247: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version
2020-12-09 04:38:52.952791: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2020-12-09 04:38:53.009178: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1618] Found device 0 with properties: 
name: Tesla P100-PCIE-16GB major: 6 minor: 0 memoryClockRate(GHz): 1.3285
pciBusID: 0000:02:00.0
2020-12-09 04:38:53.042197: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2020-12-09 04:38:53.125552: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2020-12-09 04:38:53.271278: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10.0
2020-12-09 04:38:53.831804: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10.0
2020-12-09 04:38:53.913346: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2020-12-09 04:38:54.059945: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10.0
2020-12-09 04:38:54.394170: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2020-12-09 04:38:54.395996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1746] Adding visible gpu devices: 0
2020-12-09 04:38:54.396073: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.0
2020-12-09 04:38:54.516769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1159] Device interconnect StreamExecutor with strength 1 edge matrix:
2020-12-09 04:38:54.516866: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1165]      0 
2020-12-09 04:38:54.516889: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1178] 0:   N 
2020-12-09 04:38:54.519262: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1304] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 4884 MB memory) -> physical GPU (device: 0, name: Tesla P100-PCIE-16GB, pci bus id: 0000:02:00.0, compute capability: 6.0)
2020-12-09 04:38:54.521295: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x564a22c831d0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2020-12-09 04:38:54.521334: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Tesla P100-PCIE-16GB, Compute Capability 6.0
WARNING:tensorflow:From AIP_bnn.py:384: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

WARNING:tensorflow:From AIP_bnn.py:384: The name tf.global_variables_initializer is deprecated. Please use tf.compat.v1.global_variables_initializer instead.

2020-12-09 04:38:55.536155: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
2020-12-09 04:38:56.380492: I tensorflow/core/kernels/cuda_solvers.cc:159] Creating CudaSolver handles for stream 0x564a22c75580
2020-12-09 04:38:56.380704: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10.0
2020-12-09 04:38:56.612868: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10.0
