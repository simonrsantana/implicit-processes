setwd("/home/simon/Desktop/implicit-variational-inference/synthetic_data/bimodal_carlitos/1.0/")
library(ggplot2)
library(reshape2)
require(gridExtra)
library(ggpubr)
# theme_set(theme_pubr())
# Prepare the first plot with the evolution of the induced points
data <- read.csv("IPs_split_0_bim_data.txt")
ips <- ncol(data) - 1
names(data) <- c("epoch", c(1:ips))
mdata <- melt(data, id.vars = "epoch") #, variable.name = "IP")
ips_plot <- ggplot(mdata, aes(value, epoch, col = variable, alpha = 0.95)) +
geom_line() + theme_bw() + theme(legend.position = "none") +
xlab("x") + ylab("epoch") + theme(plot.title = element_text(hjust = 0.5)) +
xlim(-2, 2) + scale_y_log10()
# Prepare the second plot with the results of the algorithm
# train_data <- read.table("synth_data_tmp.txt")
data_res <- read.csv("test_results_1.0_split_0.csv")
nsamples <- ncol(data_res) - 2
names(data_res) <- c("x", "y", c(1:nsamples))
data_res$mean_estimate <- rowMeans(data_res[, 3:(nsamples + 2)])
data_res <- data_res[order(data_res$x),]
mres <- melt(data_res, id.vars = c("x", "y", "mean_estimate"), variable.name = "sample")
res_plot <- ggplot(mres, aes(x*1.06,value)) + geom_point( color = "lightblue", alpha = 0.5) + theme_bw() +
theme(legend.position = "none") +
ggtitle("Test results") +
xlab("") + ylab("y") + theme(plot.title = element_text(hjust = 0.5)) +
geom_point(aes(x*1.06, y), color = "black") +
geom_line(aes(x*1.06, mean_estimate), color = "darkblue") +  xlim(-2, 2)
res_plot
x_test <- seq(min_x, max_x, by = 0.1)
eps_test <- rnorm(length(x_test), sd = 2)
disc <- runif(length(x_test), min = 0, max = 1)
data_test <- data.frame(x = x_1, y = x_1) # Hacemos el preset de "y" y luego lo sobreescribimos
data_test$y[disc < 0.5] <- 10*cos(x_1[disc < 0.5] - 0.5) + eps_2[disc < 0.5]
data_test$y[disc > 0.5] <- 10*sin(x_1[disc > 0.5] - 0.5) + eps_1[disc > 0.5]
data_test <- data.frame(x = x_test, y = y_test)
plot(data_test$x, data_test$y)
x_test <- seq(min_x, max_x, by = 0.1)
eps_test <- rnorm(length(x_test), sd = 2)
# Generate synth problems to test the IPs method
setwd("/home/simon/Desktop/implicit-variational-inference/implicit-processes/")
set.seed(123)
samples = 2000
error_factor = 1
# Heterocedastic problem
min_x = -4
max_x = 4
x_test <- seq(min_x, max_x, by = 0.1)
eps_test <- rnorm(length(x_test), sd = 2)
disc <- runif(length(x_test), min = 0, max = 1)
data_test <- data.frame(x = x_test, y = x_test) # Hacemos el preset de "y" y luego lo sobreescribimos
data_test$y[disc < 0.5] <- 10*cos(x_1[disc < 0.5] - 0.5) + eps_2[disc < 0.5]
data_test$y[disc < 0.5] <- 10*cos(x_test[disc < 0.5] - 0.5) + eps_2[disc < 0.5]
x_test <- seq(min_x, max_x, by = 0.1)
eps_test <- rnorm(length(x_test), sd = 2)
eps_1 <- rnorm(length(x_test))
eps_2 <- rnorm(length(x_test))
disc <- runif(length(x_test), min = 0, max = 1)
data_test <- data.frame(x = x_test, y = x_test) # Hacemos el preset de "y" y luego lo sobreescribimos
data_test$y[disc < 0.5] <- 10*cos(x_test[disc < 0.5] - 0.5) + eps_2[disc < 0.5]
data_test$y[disc > 0.5] <- 10*sin(x_test[disc > 0.5] - 0.5) + eps_1[disc > 0.5]
data_test <- data.frame(x = x_test, y = y_test)
plot(data_test$x, data_test$y)
x_test <- seq(min_x, max_x, by = 0.01)
eps_test <- rnorm(length(x_test), sd = 2)
eps_1 <- rnorm(length(x_test))
eps_2 <- rnorm(length(x_test))
disc <- runif(length(x_test), min = 0, max = 1)
data_test <- data.frame(x = x_test, y = x_test) # Hacemos el preset de "y" y luego lo sobreescribimos
data_test$y[disc < 0.5] <- 10*cos(x_test[disc < 0.5] - 0.5) + eps_2[disc < 0.5]
data_test$y[disc > 0.5] <- 10*sin(x_test[disc > 0.5] - 0.5) + eps_1[disc > 0.5]
plot(data_test$x, data_test$y)
x_test <- seq(min_x, max_x, by = 0.05)
eps_test <- rnorm(length(x_test), sd = 2)
eps_1 <- rnorm(length(x_test))
eps_2 <- rnorm(length(x_test))
disc <- runif(length(x_test), min = 0, max = 1)
data_test <- data.frame(x = x_test, y = x_test) # Hacemos el preset de "y" y luego lo sobreescribimos
data_test$y[disc < 0.5] <- 10*cos(x_test[disc < 0.5] - 0.5) + eps_2[disc < 0.5]
data_test$y[disc > 0.5] <- 10*sin(x_test[disc > 0.5] - 0.5) + eps_1[disc > 0.5]
plot(data_test$x, data_test$y)
write.table(x = data_test, file = "heteroc_test.txt", col.names = F, row.names = F)
x_1 <- runif(samples, min = min_x, max = max_x)
setwd("/home/simon/Desktop/implicit-variational-inference/implicit-processes/")
write.table(x = data_test, file = "heteroc_test.txt", col.names = F, row.names = F)
library(reshape)
library(ggplot2)
alphas = c("0.0001", 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, "1.0")
n_alphas  = length(alphas)
setwd("/home/simon/Desktop/implicit-variational-inference/synthetic_data/bimodal_carlitos/")
results_file0 <- paste0(as.character(alphas[11]), "/test_results_", as.character(alphas[11]), "_split_0.csv")
results0 <- read.csv(results_file0)
x0 <- results0$X0
y0 <- results0$X0.1
for (i in 1:n_alphas){
setwd("/home/simon/Desktop/implicit-variational-inference/synthetic_data/bimodal_carlitos/")
results_file <- paste0(as.character(alphas[i]), "/test_results_", as.character(alphas[i]), "_split_0.csv")
results <- read.csv(results_file)
names(results) <- c("x", "y", 1:(ncol(results) - 2))
results$mean_estimate <- rowMeans(results[,3:(ncol(results))])
results$x <- x0
results$y <- y0
melted <- melt(results, id.vars = c("x", "y", "mean_estimate"), variable_name = "sample")
# setwd("/home/simon/Desktop/implicit-variational-inference/synthetic_data/plots/heteroc/")
# pdf(file = paste0(alphas[i], "_mod.pdf"), width=10, height=8, pointsize=12)
# plot(melted05, pch = 20, col = rgb(0,0,1, alpha = 0.1), ylim = c(-15, 15), main = paste("alpha =", alphas[i]),
#      xlab = "", ylab = "", cex.main = 3, cex.axis = 2)
# dev.off()
#
setwd("/home/simon/Desktop/implicit-variational-inference/synthetic_data/plots/bim/")
res_plot <- ggplot(melted, aes(x,value)) + geom_point( color = "blue", alpha = 0.2) + theme_bw() +
theme(legend.position = "none") +
ggtitle(paste0("Test results, alpha = ", as.character(alphas[i]))) +
xlab("x") + ylab("y") + theme(plot.title = element_text(hjust = 0.5)) +
geom_point(aes(x, y), color = "black") +
geom_line(aes(x, mean_estimate), color = "darkred") # +  xlim(-2, 2)
# res_plot
ggsave(file = paste0("2_", alphas[i], "_bim.png"), width=8, height=4, pointsize=12)
}
for (i in 1:n_alphas){
setwd("/home/simon/Desktop/implicit-variational-inference/synthetic_data/bimodal_carlitos/")
results_file <- paste0(as.character(alphas[i]), "/test_results_", as.character(alphas[i]), "_split_0.csv")
results <- read.csv(results_file)
names(results) <- c("x", "y", 1:(ncol(results) - 2))
results$mean_estimate <- rowMeans(results[,3:(ncol(results))])
#results$x <- x0
#results$y <- y0
melted <- melt(results, id.vars = c("x", "y", "mean_estimate"), variable_name = "sample")
# setwd("/home/simon/Desktop/implicit-variational-inference/synthetic_data/plots/heteroc/")
# pdf(file = paste0(alphas[i], "_mod.pdf"), width=10, height=8, pointsize=12)
# plot(melted05, pch = 20, col = rgb(0,0,1, alpha = 0.1), ylim = c(-15, 15), main = paste("alpha =", alphas[i]),
#      xlab = "", ylab = "", cex.main = 3, cex.axis = 2)
# dev.off()
#
setwd("/home/simon/Desktop/implicit-variational-inference/synthetic_data/plots/bim/")
res_plot <- ggplot(melted, aes(x,value)) + geom_point( color = "blue", alpha = 0.2) + theme_bw() +
theme(legend.position = "none") +
ggtitle(paste0("Test results, alpha = ", as.character(alphas[i]))) +
xlab("x") + ylab("y") + theme(plot.title = element_text(hjust = 0.5)) +
geom_point(aes(x, y), color = "black") +
geom_line(aes(x, mean_estimate), color = "darkred") # +  xlim(-2, 2)
# res_plot
ggsave(file = paste0("2_", alphas[i], "_bim.png"), width=8, height=4, pointsize=12)
}
i = 10
alphas[i]
setwd("/home/simon/Desktop/implicit-variational-inference/synthetic_data/bimodal_carlitos/")
results_file <- paste0(as.character(alphas[i]), "/test_results_", as.character(alphas[i]), "_split_0.csv")
results <- read.csv(results_file)
names(results) <- c("x", "y", 1:(ncol(results) - 2))
results$mean_estimate <- rowMeans(results[,3:(ncol(results))])
#results$x <- x0
#results$y <- y0
melted <- melt(results, id.vars = c("x", "y", "mean_estimate"), variable_name = "sample")
# setwd("/home/simon/Desktop/implicit-variational-inference/synthetic_data/plots/heteroc/")
# pdf(file = paste0(alphas[i], "_mod.pdf"), width=10, height=8, pointsize=12)
# plot(melted05, pch = 20, col = rgb(0,0,1, alpha = 0.1), ylim = c(-15, 15), main = paste("alpha =", alphas[i]),
#      xlab = "", ylab = "", cex.main = 3, cex.axis = 2)
# dev.off()
#
setwd("/home/simon/Desktop/implicit-variational-inference/synthetic_data/plots/bim/")
res_plot <- ggplot(melted, aes(x,value)) + geom_point( color = "blue", alpha = 0.2) + theme_bw() +
theme(legend.position = "none") +
ggtitle(paste0("Test results, alpha = ", as.character(alphas[i]))) +
xlab("x") + ylab("y") + theme(plot.title = element_text(hjust = 0.5)) +
geom_point(aes(x, y), color = "black") +
geom_line(aes(x, mean_estimate), color = "darkred") # +  xlim(-2, 2)
# res_plot
ggsave(file = paste0("2_", alphas[i], "_bim.png"), width=8, height=4, pointsize=12)
